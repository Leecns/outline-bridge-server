# Outline Bridge Server

This repository contains V2Ray Docker Compose files to run a bridge server for the Outline proxy.
It helps Outline proxy to work in highly restricted networks.

## Documentation

### Outline

[Outline](https://getoutline.org) is a Shadowsocks-based proxy created by Google.
It lets you create and manage Shadowsocks servers easily.
Outline clients are well-designed applications available for all platforms.

It usually works as below.

```
[Outline client] <-> [Outline server] <-> (Internet)
```

### The Bridge Server

The bridge server will be inserted between clients and a server to connect the clients to the server
in networks where this connection is not possible directly.
It runs a V2Ray proxy to pass the incoming Shadowsocks traffic from clients to the Outline server.

The bridge server changes the flow as below.

```
[Outline client] <-> [V2Ray server] <-> [Outline server] <-> (Internet)
```

### Setup Outline

Read the [Outline official documentation](https://getoutline.org/get-started) to set up an Outline server using the Outline Manager application.

### Setup the bridge server

Follow these steps to run the V2Ray proxy on the bridge server.

1. Install Docker and Docker-compose.
1. Clone this repository into the bridge server.
1. Run `./setup.py` script. It gets the following inputs:
    1. `Outline Server Hostname`: Find it in Outline Manager > {Server} > Settings > Hostname
    1. `Outline Server Port`: Find it in Outline Manager > {Server} > Settings > Port
    1. `V2Ray Port`: Enter a port for V2Ray (entering the same Outline server port is a good practice)
1. Run `docker-compose up -d`.

### Use the bridge server

The Outline Manager generates Outline (Shadowsocks) links for users.
This is a sample link generated by the Outline Manager:

```
ss://abc123xyz@13.13.13.13:1080/?outline=1
# ss://{credentials}@{hostname}:{port}/?outline=1
```

To make users use the bridge server,
you must change the hostname (13.13.13.13) and port (1080) in the original link to the bridge hostname and port.
The `./convert.py` script can handle this link conversion.

Run the `./convert.py` script.
* It gets the following inputs:
   1. `Bridge Hostname`: Enter the bridge server IP address or domain.
   1. `Original Outline Link`: Enter the original ss:// link generated by the Outline Manager.
* It prints the following outputs:
   1. `New Outline Link`: The new Outline link with bridge hostname and port.
   1. `New Invitation Link`: The new invitation link to share with your users.

### Docker images

* GitHub:
    * Image: ```ghcr.io/getimages/v2fly-core:v4.45.2```
    * URL: https://github.com/orgs/getimages/packages/container/package/v2fly-core
    * Digest: `sha256:289fc9451f21a265f95615e29f05ea23bc32026db152863eee317738813521d7`
* Docker Hub:
    * Image: ```v2fly/v2fly-core:v4.45.2```
    * URL: https://hub.docker.com/r/v2fly/v2fly-core/tags
    * Digest: `sha256:289fc9451f21a265f95615e29f05ea23bc32026db152863eee317738813521d7`

## More

* [V2Ray Docker Compose (Bridge and Upstream Servers)](https://github.com/miladrahimi/v2ray-docker-compose)
